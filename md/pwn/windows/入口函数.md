---
title: 入口函数
updated: 2022-04-14T15:25:10.0000000+08:00
created: 2021-01-29T14:24:34.0000000+08:00
---

\_security_init_cookie

\_security_init_cookie(使用/GS选项后提供)的作用是通过初始化一个全部变量用来检测局部缓冲区溢出和对函数返回地址潜在的修改(这可能导致程序执行流程改变，以至于执行不安全的shellcode)。
下图是使用了/GS选项后的函数栈帧：

| L   |           |                 |
|-----|------------|------------------|
|    | ARG2       | 参数2            |
|    | ARG1       | 参数1            |
|    | COOKIE VAR | cookie变量       |
|    | EBP        | EBP栈指针        |
| H   | RET        | 函数返回地址  |
看到这个布局，就可以猜到，如果cookie被改变了(因为人为的缓冲区溢出导致)，那么很有可能函数的返回地址被改变了，也可能ebp改变了。这样便能检测危险所在。

*来自 \<<https://blog.csdn.net/wangpengk7788/article/details/53891857>\>*

